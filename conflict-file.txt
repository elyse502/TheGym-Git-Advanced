This is the resolved version combining both changes
